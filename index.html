<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Clientes - Luana Bonini</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Firebase SDK (versão compat para simplicidade) -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
    <style>
        /* Todo o CSS anterior permanece igual */
        :root {
            --bg-color: #eef2f7;
            --text-color: #34495e;
            --header-bg-start: #3498db;
            --header-bg-end: #2980b9;
            --card-bg: white;
            --input-bg: #f9fafb;
            --shadow: rgba(0, 0, 0, 0.1);
            --error-color: #e74c3c;
        }
        [data-theme="dark"] {
            --bg-color: #2c3e50;
            --text-color: #ecf0f1;
            --header-bg-start: #1abc9c;
            --header-bg-end: #16a085;
            --card-bg: #34495e;
            --input-bg: #3d566e;
            --shadow: rgba(255, 255, 255, 0.1);
        }
        /* Resto do CSS igual ao anterior */
    </style>
</head>
<body>
    <div class="header">
        <h1>Controle de Clientes - Luana Bonini</h1>
        <button class="theme-toggle" aria-label="Alternar tema">
            <i class="fas fa-moon"></i>
        </button>
    </div>
    <div class="container">
        <div class="tabs">
            <button class="tab-btn active" data-tab="clientes">Clientes</button>
            <button class="tab-btn" data-tab="financeiro">Financeiro</button>
        </div>

        <!-- Aba Clientes -->
        <div id="clientes" class="tab-content active">
            <form id="clienteForm">
                <label for="nome">Nome</label>
                <input type="text" id="nome" required placeholder="Digite o nome completo">
                <div class="error-message" id="nome-error">Nome é obrigatório</div>

                <label for="celular">Número de Celular</label>
                <input type="tel" id="celular" required pattern="\(\d{2}\)\s\d{5}-\d{4}" placeholder="(11) 98765-4321">
                <div class="error-message" id="celular-error">Use o formato (XX) XXXXX-XXXX</div>

                <label for="plano">Tipo de Plano</label>
                <select id="plano" required>
                    <option value="" disabled selected>Selecione um plano</option>
                    <option value="Mensal">Mensal</option>
                    <option value="Trimestral">Trimestral</option>
                </select>

                <label for="valor">Valor do Plano (R$)</label>
                <input type="number" id="valor" step="0.01" min="0" required placeholder="Ex.: 150.00">
                <div class="error-message" id="valor-error">Digite um valor válido (mínimo 0)</div>

                <label for="ultimaConsulta">Última Consulta (opcional)</label>
                <input type="date" id="ultimaConsulta">

                <label for="proximaConsulta">Próxima Consulta (opcional)</label>
                <input type="date" id="proximaConsulta">

                <label for="observacoes">Observações</label>
                <textarea id="observacoes" rows="3" placeholder="Notas sobre o cliente"></textarea>

                <button type="submit" class="add-btn"><i class="fas fa-plus icon"></i>Adicionar Cliente</button>
            </form>

            <div id="message" class="success"></div>

            <div class="export-import">
                <button id="exportBtn" class="add-btn"><i class="fas fa-download icon"></i>Exportar CSV</button>
                <input type="file" id="importInput" accept=".csv" style="display: none;">
                <button id="importBtn" class="add-btn"><i class="fas fa-upload icon"></i>Importar CSV</button>
            </div>
            <div class="reports">
                <h3>Relatórios</h3>
                <p id="reportSummary"></p>
            </div>

            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Pesquisar por nome ou celular...">
                <button class="filter-btn" data-filter="Todos">Todos</button>
                <button class="filter-btn" data-filter="Pago">Pago</button>
                <button class="filter-btn" data-filter="Pendente">Pendente</button>
                <button class="filter-btn" data-filter="Vencido">Vencido</button>
            </div>

            <div class="table-container">
                <table id="clientesTable">
                    <thead>
                        <tr>
                            <th class="sortable" data-sort="nome">Nome <span class="sort-arrow"></span></th>
                            <th>Número de Celular</th>
                            <th>Plano</th>
                            <th>Valor</th>
                            <th>Início</th>
                            <th class="sortable" data-sort="vencimento">Vencimento <span class="sort-arrow"></span></th>
                            <th class="sortable" data-sort="status">Status <span class="sort-arrow"></span></th>
                            <th>Próxima Consulta</th>
                            <th>Histórico</th>
                            <th>Observações</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Aba Financeiro -->
        <div id="financeiro" class="tab-content">
            <div class="financial-summary">
                <h3>Resumo Financeiro</h3>
                <p id="financialSummary"></p>
            </div>
            <div class="table-container">
                <table id="financeTable">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Plano</th>
                            <th>Valor (R$)</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <!-- Modal de Edição -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <button class="close-modal" onclick="document.getElementById('editModal').style.display = 'none'"><i class="fas fa-times"></i></button>
                <h3><i class="fas fa-edit icon"></i>Editar Cliente</h3>
                <form id="editForm">
                    <label for="editNome">Nome</label>
                    <input type="text" id="editNome" required placeholder="Digite o nome completo">
                    <div class="error-message" id="editNome-error">Nome é obrigatório</div>

                    <label for="editCelular">Número de Celular</label>
                    <input type="tel" id="editCelular" required pattern="\(\d{2}\)\s\d{5}-\d{4}" placeholder="(11) 98765-4321">
                    <div class="error-message" id="editCelular-error">Use o formato (XX) XXXXX-XXXX</div>

                    <label for="editPlano">Tipo de Plano</label>
                    <select id="editPlano" required>
                        <option value="Mensal">Mensal</option>
                        <option value="Trimestral">Trimestral</option>
                    </select>

                    <label for="editValor">Valor do Plano (R$)</label>
                    <input type="number" id="editValor" step="0.01" min="0" required placeholder="Ex.: 150.00">
                    <div class="error-message" id="editValor-error">Digite um valor válido (mínimo 0)</div>

                    <label for="editInicio">Início</label>
                    <input type="date" id="editInicio" required>

                    <label for="editVencimento">Vencimento</label>
                    <input type="date" id="editVencimento" required>

                    <label for="editUltimaConsulta">Última Consulta</label>
                    <input type="date" id="editUltimaConsulta">

                    <label for="editProximaConsulta">Próxima Consulta</label>
                    <input type="date" id="editProximaConsulta">

                    <label for="editObservacoes">Observações</label>
                    <textarea id="editObservacoes" rows="2" placeholder="Notas sobre o cliente"></textarea>

                    <div style="display: flex; justify-content: space-between;">
                        <button type="submit" class="save-btn"><i class="fas fa-save icon"></i>Salvar</button>
                        <button type="button" id="cancelEdit" class="cancel-btn"><i class="fas fa-times icon"></i>Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal para renovação -->
        <div id="renewModal" class="modal">
            <div class="modal-content">
                <button class="close-modal" onclick="document.getElementById('renewModal').style.display = 'none'"><i class="fas fa-times"></i></button>
                <h3>Renovar Plano</h3>
                <p>Escolha o novo tipo de plano:</p>
                <button id="renewMensal" class="renovar-btn"><i class="fas fa-calendar icon"></i>Mensal</button>
                <button id="renewTrimestral" class="renovar-btn"><i class="fas fa-calendar-alt icon"></i>Trimestral</button><br>
                <button id="cancelRenew" class="cancel-btn"><i class="fas fa-times icon"></i>Cancelar</button>
            </div>
        </div>

        <!-- Modal para confirmação de exclusão -->
        <div id="deleteModal" class="modal">
            <div class="modal-content">
                <button class="close-modal" onclick="document.getElementById('deleteModal').style.display = 'none'"><i class="fas fa-times"></i></button>
                <h3><i class="fas fa-exclamation-triangle icon"></i>Confirmar Exclusão</h3>
                <p id="deleteMessage">Tem certeza que deseja excluir este cliente?</p>
                <button id="confirmDelete" class="confirm-btn"><i class="fas fa-check icon"></i>Sim</button>
                <button id="cancelDelete" class="cancel-btn"><i class="fas fa-times icon"></i>Não</button>
            </div>
        </div>

        <!-- Modal para histórico de consultas -->
        <div id="historyModal" class="modal">
            <div class="modal-content">
                <button class="close-modal" onclick="document.getElementById('historyModal').style.display = 'none'"><i class="fas fa-times"></i></button>
                <h3><i class="fas fa-history icon"></i>Histórico de Consultas</h3>
                <ul id="historyList"></ul>
                <button id="addHistory" class="renovar-btn"><i class="fas fa-plus icon"></i>Adicionar Consulta</button>
                <button id="closeHistory" class="cancel-btn"><i class="fas fa-times icon"></i>Fechar</button>
            </div>
        </div>

        <!-- Modal para observações -->
        <div id="observationsModal" class="modal">
            <div class="modal-content">
                <button class="close-modal" onclick="document.getElementById('observationsModal').style.display = 'none'"><i class="fas fa-times"></i></button>
                <h3><i class="fas fa-eye icon"></i>Observações</h3>
                <p id="observationsText"></p>
                <button id="closeObservations" class="cancel-btn"><i class="fas fa-times icon"></i>Fechar</button>
            </div>
        </div>
    </div>

    <script>
        // Inicializando o Firebase com seu firebaseConfig
        const firebaseConfig = {
            apiKey: "AIzaSyDECV4rYRQ81PzornvU0kocSBOp8WxF6Bc",
            authDomain: "luana-bonini.firebaseapp.com",
            projectId: "luana-bonini",
            storageBucket: "luana-bonini.firebasestorage.app",
            messagingSenderId: "770840237104",
            appId: "1:770840237104:web:68032c078a2b63d2d649f5"
        };

        // Inicializa o Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const clientsRef = database.ref('clients');

        // Função para alternar tema
        function toggleTheme() {
            const body = document.body;
            const icon = document.querySelector('.theme-toggle i');
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                icon.classList.replace('fa-sun', 'fa-moon');
            } else {
                body.setAttribute('data-theme', 'dark');
                icon.classList.replace('fa-moon', 'fa-sun');
            }
        }

        // Validação de formulário
        function validateForm(formId) {
            const form = document.getElementById(formId);
            const inputs = form.querySelectorAll('input[required], select[required]');
            let isValid = true;

            inputs.forEach(input => {
                const errorElement = document.getElementById(`${input.id}-error`);
                if (!input.checkValidity()) {
                    errorElement.style.display = 'block';
                    input.style.borderColor = 'var(--error-color)';
                    isValid = false;
                } else {
                    errorElement.style.display = 'none';
                    input.style.borderColor = '#dcdcdc';
                }
            });

            return isValid;
        }

        // Adicionar cliente
        document.getElementById('clienteForm').addEventListener('submit', function(event) {
            event.preventDefault();
            if (validateForm('clienteForm')) {
                const nome = document.getElementById('nome').value;
                const celular = document.getElementById('celular').value;
                const plano = document.getElementById('plano').value;
                const valor = document.getElementById('valor').value;
                const ultimaConsulta = document.getElementById('ultimaConsulta').value;
                const proximaConsulta = document.getElementById('proximaConsulta').value;
                const observacoes = document.getElementById('observacoes').value;

                clientsRef.once('value', snapshot => {
                    const clients = snapshot.val() || {};
                    if (Object.values(clients).some(client => client.celular === celular)) {
                        document.getElementById('celular-error').textContent = 'Número já cadastrado!';
                        document.getElementById('celular-error').style.display = 'block';
                        return;
                    }

                    const hoje = new Date();
                    const novoCliente = {
                        nome,
                        celular,
                        plano,
                        valor,
                        inicio: formatDate(hoje),
                        vencimento: calculateDueDate(hoje, plano),
                        status: 'Pendente',
                        ultimaConsulta,
                        proximaConsulta,
                        observacoes,
                        history: []
                    };

                    const newClientRef = clientsRef.push();
                    newClientRef.set(novoCliente).then(() => {
                        document.getElementById('message').textContent = 'Cliente adicionado com sucesso!';
                        setTimeout(() => document.getElementById('message').textContent = '', 3000);
                        this.reset();
                        loadClients();
                    });
                });
            }
        });

        // Carregar clientes do Firebase
        let sortState = { column: null, direction: 'asc' };
        function loadClients(filter = 'Todos', searchTerm = '') {
            clientsRef.on('value', snapshot => {
                const clients = snapshot.val() || {};
                const tbody = document.querySelector('#clientesTable tbody');
                tbody.innerHTML = '';
                let filteredClients = Object.entries(clients).map(([id, client]) => ({ id, ...client })).filter(client => {
                    const matchesSearch = client.nome.toLowerCase().includes(searchTerm.toLowerCase()) || 
                                         client.celular.toLowerCase().includes(searchTerm.toLowerCase());
                    if (filter === 'Todos') return matchesSearch;
                    if (filter === 'Vencido') return matchesSearch && isDueDateExpired(client.vencimento) && client.status !== 'Pago';
                    return matchesSearch && client.status === filter;
                });

                if (sortState.column) {
                    filteredClients.sort((a, b) => {
                        let valA = a[sortState.column];
                        let valB = b[sortState.column];
                        if (sortState.column === 'vencimento') {
                            valA = new Date(valA);
                            valB = new Date(valB);
                        }
                        return sortState.direction === 'asc' ? (valA > valB ? 1 : -1) : (valA < valB ? 1 : -1);
                    });
                }

                filteredClients.forEach(client => addClientToTable(client, client.id));
                updateReports(clients);
                loadFinancialData(clients);
                updateSortArrows();
            });
        }

        // Adicionar cliente à tabela
        function addClientToTable(client, id) {
            const table = document.querySelector('#clientesTable tbody');
            const newRow = table.insertRow();
            newRow.insertCell(0).textContent = client.nome;
            newRow.insertCell(1).textContent = client.celular;
            newRow.insertCell(2).textContent = client.plano;
            newRow.insertCell(3).textContent = `R$ ${parseFloat(client.valor).toFixed(2)}`;
            newRow.insertCell(4).textContent = client.inicio;
            const vencimentoCell = newRow.insertCell(5);
            vencimentoCell.innerHTML = `${client.vencimento} ${isNearDueDate(client.vencimento) ? '<i class="fas fa-bell icon" style="color: #f39c12;"></i>' : ''}`;
            const statusCell = newRow.insertCell(6);
            statusCell.innerHTML = `${client.status === 'Pago' ? '<i class="fas fa-check-circle status-icon" style="color: #27ae60;"></i>' : '<i class="fas fa-exclamation-circle status-icon" style="color: #f39c12;"></i>'} ${client.status}`;
            newRow.insertCell(7).textContent = client.proximaConsulta || '-';
            const historyCell = newRow.insertCell(8);
            historyCell.innerHTML = `<button class="view-btn action-btn" onclick="showHistoryModal('${id}')"><i class="fas fa-history icon"></i>Ver</button>`;
            const obsCell = newRow.insertCell(9);
            obsCell.innerHTML = `<button class="view-btn action-btn" onclick="showObservations('${client.observacoes || '-'}')"><i class="fas fa-eye icon"></i>Ver</button>`;
            const actionsCell = newRow.insertCell(10);
            actionsCell.innerHTML = `
                <button class="pago-btn action-btn" onclick="updateStatus('${id}', 'Pago')"><i class="fas fa-check icon"></i>Pago</button>
                <button class="pendente-btn action-btn" onclick="updateStatus('${id}', 'Pendente')"><i class="fas fa-hourglass-half icon"></i>Pendente</button>
                <button class="renovar-btn action-btn" onclick="showRenewModal('${id}')"><i class="fas fa-sync-alt icon"></i>Renovar</button>
                <button class="edit-btn action-btn" onclick="showEditModal('${id}')"><i class="fas fa-edit icon"></i>Editar</button>
                <button class="excluir-btn action-btn" onclick="showDeleteModal('${id}')"><i class="fas fa-trash-alt icon"></i>Excluir</button>
            `;
            if (isDueDateExpired(client.vencimento) && client.status !== 'Pago') {
                newRow.classList.add('vencido');
            }
        }

        // Atualizar status
        function updateStatus(id, status) {
            clientsRef.child(id).update({ status }).then(() => loadClients());
        }

        // Funções de apoio
        function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function calculateDueDate(startDate, planType) {
            const dueDate = new Date(startDate);
            if (planType === 'Mensal') dueDate.setMonth(dueDate.getMonth() + 1);
            else if (planType === 'Trimestral') dueDate.setMonth(dueDate.getMonth() + 3);
            return formatDate(dueDate);
        }

        function isDueDateExpired(dueDate) {
            return new Date(dueDate) < new Date();
        }

        function isNearDueDate(dueDate) {
            const today = new Date();
            const diffDays = Math.ceil((new Date(dueDate) - today) / (1000 * 60 * 60 * 24));
            return diffDays <= 5 && diffDays >= 0;
        }

        function updateSortArrows() {
            document.querySelectorAll('.sortable').forEach(th => {
                const arrow = th.querySelector('.sort-arrow');
                const column = th.getAttribute('data-sort');
                if (sortState.column === column) {
                    arrow.innerHTML = sortState.direction === 'asc' ? '<i class="fas fa-arrow-up"></i>' : '<i class="fas fa-arrow-down"></i>';
                } else {
                    arrow.innerHTML = '';
                }
            });
        }

        function loadFinancialData(clients) {
            const tbody = document.querySelector('#financeTable tbody');
            tbody.innerHTML = '';
            Object.entries(clients).forEach(([_, client]) => {
                const row = tbody.insertRow();
                row.insertCell(0).textContent = client.nome;
                row.insertCell(1).textContent = client.plano;
                row.insertCell(2).textContent = `R$ ${parseFloat(client.valor).toFixed(2)}`;
                row.insertCell(3).textContent = client.status;
                if (isDueDateExpired(client.vencimento) && client.status !== 'Pago') {
                    row.classList.add('vencido');
                }
            });
            const totalRevenue = Object.values(clients).reduce((sum, c) => sum + (c.status === 'Pago' ? parseFloat(c.valor) : 0), 0);
            const pendingRevenue = Object.values(clients).reduce((sum, c) => sum + (c.status === 'Pendente' ? parseFloat(c.valor) : 0), 0);
            document.getElementById('financialSummary').innerHTML = `
                Receita Total: R$ ${totalRevenue.toFixed(2)} | Receita Pendente: R$ ${pendingRevenue.toFixed(2)}
            `;
        }

        function updateReports(clients) {
            const totalClients = Object.keys(clients).length;
            const paidClients = Object.values(clients).filter(c => c.status === 'Pago').length;
            const pendingClients = Object.values(clients).filter(c => c.status === 'Pendente').length;
            const expiredClients = Object.values(clients).filter(c => isDueDateExpired(c.vencimento) && c.status !== 'Pago').length;
            document.getElementById('reportSummary').innerHTML = `
                Total de Clientes: ${totalClients} | Pagos: ${paidClients} | Pendentes: ${pendingClients} | Vencidos: ${expiredClients}
            `;
        }

        let currentId = null;

        function showRenewModal(id) {
            currentId = id;
            document.getElementById('renewModal').style.display = 'flex';
        }

        function renewPlan(planType) {
            const hoje = new Date();
            const updates = {
                plano: planType,
                inicio: formatDate(hoje),
                vencimento: calculateDueDate(hoje, planType),
                status: 'Pago'
            };
            clientsRef.child(currentId).update(updates).then(() => {
                clientsRef.child(currentId).once('value', snapshot => {
                    const client = snapshot.val();
                    document.getElementById('message').textContent = `Plano de ${client.nome} renovado para ${planType} e marcado como Pago!`;
                    setTimeout(() => document.getElementById('message').textContent = '', 3000);
                });
                document.getElementById('renewModal').style.display = 'none';
            });
        }

        function showDeleteModal(id) {
            currentId = id;
            clientsRef.child(id).once('value', snapshot => {
                const client = snapshot.val();
                document.getElementById('deleteMessage').textContent = `Tem certeza que deseja excluir ${client.nome}?`;
                document.getElementById('deleteModal').style.display = 'flex';
            });
        }

        function showEditModal(id) {
            currentId = id;
            clientsRef.child(id).once('value', snapshot => {
                const client = snapshot.val();
                document.getElementById('editNome').value = client.nome;
                document.getElementById('editCelular').value = client.celular;
                document.getElementById('editPlano').value = client.plano;
                document.getElementById('editValor').value = client.valor;
                document.getElementById('editInicio').value = client.inicio;
                document.getElementById('editVencimento').value = client.vencimento;
                document.getElementById('editUltimaConsulta').value = client.ultimaConsulta || '';
                document.getElementById('editProximaConsulta').value = client.proximaConsulta || '';
                document.getElementById('editObservacoes').value = client.observacoes || '';
                document.getElementById('editModal').style.display = 'flex';
            });
        }

        document.getElementById('editForm').addEventListener('submit', function(event) {
            event.preventDefault();
            if (validateForm('editForm')) {
                const updates = {
                    nome: document.getElementById('editNome').value,
                    celular: document.getElementById('editCelular').value,
                    plano: document.getElementById('editPlano').value,
                    valor: document.getElementById('editValor').value,
                    inicio: document.getElementById('editInicio').value,
                    vencimento: document.getElementById('editVencimento').value,
                    ultimaConsulta: document.getElementById('editUltimaConsulta').value,
                    proximaConsulta: document.getElementById('editProximaConsulta').value,
                    observacoes: document.getElementById('editObservacoes').value
                };
                clientsRef.child(currentId).update(updates).then(() => {
                    document.getElementById('message').textContent = 'Cliente editado com sucesso!';
                    setTimeout(() => document.getElementById('message').textContent = '', 3000);
                    document.getElementById('editModal').style.display = 'none';
                });
            }
        });

        function showHistoryModal(id) {
            currentId = id;
            clientsRef.child(id).once('value', snapshot => {
                const client = snapshot.val();
                const historyList = document.getElementById('historyList');
                historyList.innerHTML = '';
                if (!client.history || client.history.length === 0) {
                    const li = document.createElement('li');
                    li.textContent = 'Nenhuma consulta registrada.';
                    historyList.appendChild(li);
                } else {
                    client.history.forEach((entry, i) => {
                        const li = document.createElement('li');
                        li.textContent = `${entry.date} - ${entry.notes || 'Sem anotações'}`;
                        historyList.appendChild(li);
                    });
                }
                document.getElementById('historyModal').style.display = 'flex';
            });
        }

        function showObservations(text) {
            document.getElementById('observationsText').textContent = text || 'Nenhuma observação registrada.';
            document.getElementById('observationsModal').style.display = 'flex';
        }

        document.getElementById('addHistory').addEventListener('click', () => {
            const date = prompt('Data da consulta (YYYY-MM-DD):');
            const notes = prompt('Anotações da consulta:');
            if (date) {
                clientsRef.child(currentId).once('value', snapshot => {
                    const client = snapshot.val();
                    const history = client.history || [];
                    history.push({ date, notes });
                    clientsRef.child(currentId).update({ history }).then(() => {
                        showHistoryModal(currentId);
                    });
                });
            }
        });

        document.getElementById('renewMensal').addEventListener('click', () => renewPlan('Mensal'));
        document.getElementById('renewTrimestral').addEventListener('click', () => renewPlan('Trimestral'));
        document.getElementById('cancelRenew').addEventListener('click', () => {
            document.getElementById('renewModal').style.display = 'none';
        });
        document.getElementById('confirmDelete').addEventListener('click', () => {
            clientsRef.child(currentId).remove().then(() => {
                document.getElementById('message').textContent = 'Cliente excluído com sucesso!';
                setTimeout(() => document.getElementById('message').textContent = '', 3000);
                document.getElementById('deleteModal').style.display = 'none';
            });
        });
        document.getElementById('cancelDelete').addEventListener('click', () => {
            document.getElementById('deleteModal').style.display = 'none';
        });
        document.getElementById('cancelEdit').addEventListener('click', () => {
            document.getElementById('editModal').style.display = 'none';
        });
        document.getElementById('closeHistory').addEventListener('click', () => {
            document.getElementById('historyModal').style.display = 'none';
        });
        document.getElementById('closeObservations').addEventListener('click', () => {
            document.getElementById('observationsModal').style.display = 'none';
        });
        document.getElementById('searchInput').addEventListener('input', function() {
            loadClients('Todos', this.value);
        });
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const filter = btn.getAttribute('data-filter');
                loadClients(filter, document.getElementById('searchInput').value);
            });
        });
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                btn.classList.add('active');
                document.getElementById(btn.getAttribute('data-tab')).classList.add('active');
            });
        });
        document.querySelectorAll('.sortable').forEach(th => {
            th.addEventListener('click', () => {
                const column = th.getAttribute('data-sort');
                if (sortState.column === column) {
                    sortState.direction = sortState.direction === 'asc' ? 'desc' : 'asc';
                } else {
                    sortState.column = column;
                    sortState.direction = 'asc';
                }
                loadClients(document.querySelector('.filter-btn.active')?.getAttribute('data-filter') || 'Todos', document.getElementById('searchInput').value);
            });
        });

        // Carregar inicialmente
        loadClients();
    </script>
</body>
</html>